\section{Limitante Dual}
\label{sec:limdual}

O Limitante Dual (Limitante Inferior) para o \pcmcrc{} é obtido usando o método do subgradiente.
Neste método calculamos os multiplicadores de lagrange a cada iteração. Os multiplicadores são
diferentes dependendo da relaxação lagrangeana escolhida.

A relaxação lagrangeana foi realizada sobre dois conjuntos de restrições. A Relaxação onde
o conjunto de restrições do \cmc{} foram dualizadas é chamada de \rl{1}. A Relaxação 
onde a restrição do tipo \knap{} foi dualizada é chamada de \rl{2}.

O Problema Primal Lagrangeano para cada relaxação é diferente. Para a relaxação \rl{1}, o problema
primal lagrangeano é o Problema da \knap{}. Já para a relaxação \rl{2}, o problema primal lagrangeano é o \pcmc{}.

\subsection{\rl{1} - Problema da \knap{}}
\label{subsec:relaxlag_rl1}

A relaxação \rl{1} tem como problema primal lagrangeano o Problema da \knap{}. Este é um problema de 
maximização onde desejamos pegar o maior número de \aspas{itens} satisfazendo a restrição de peso da mochila. 
Temos que $\min z = max -z$, então transformaremos o problema de minimização para um 
de maximização.

Logo temos o seguinte modelo para o problema primal lagrangeano da relaxação \rl{1}: \\

Função Objetivo:

\begin{align}
\label{eq:fo_rl1}
z(u) = \max -(&\sum_{j \in V} ((d_{s, j} + u_{s}) \cdot x_{s, j}) + \nonumber\\
&\sum_{i \in V} ((d_{i, t} + u_{t}) \cdot x_{i, t}) + \\
&\sum_{j \in V\backslash\{s, t\}} \sum_{i \in V} (d_{i, j} \cdot x_{i, j}) - u_{s} - u_{t}) \nonumber
\end{align} \\

Sujeito a:

\begin{equation}
\label{eq:restr_rl1_knap}
\sum_{(i, j) \in E} c_{i, j} . x_{i, j} \le C
\end{equation}

\begin{equation}
\label{eq:restr_rl1_x}
x_{i, j} \in \mathbb{B}, \qquad \forall (i, j) \in E
\end{equation} \\

\subsubsection{Custos Lagrangeanos}
\label{subsubsec:custo_lag_rl1}

Para a relaxação \rl{1}, os custos lagrangeanos são os custos relacionados ao vértice origem $s$ e 
ao vértice destino $t$. Como o grafo é simples e não-orientado temos que $x_{i, j} = x_{j, i}$, logo 
os multiplicadores associados a restrição (\ref{eq:restr_pli_pcmc3}) do problema original se anulam.
Então temos os seguintes custos lagrangeanos:

\begin{align}
\tilde{c}_{s, j} = d_{s, j} + u_{s}, \qquad &\text{para o vértice s}. \nonumber\\
\tilde{c}_{i, t} = d_{i, t} + u_{t}, \qquad &\text{para o vértice t}. \nonumber\\
\tilde{c}_{i, j} = d_{i, j}, \qquad &\text{para os vértices diferentes de s e t}. \nonumber
\end{align}

\subsubsection{Detalhes da Implementação}
\label{subsubsec:alg_rl1}

O algoritmo implementado para resolver o Problema da \knap{} é um algoritmo pseudo-polinomial que 
usa programação dinâmica e possui complexidade de tempo de $O(C \cdot |E|)$~\cite{wolsey}.

O algoritmo constrói a matriz de programação dinâmica e recupera a solução usando um algoritmo 
recursivo que possui complexidade de tempo de $O(|E|)$.

%O algoritmo implementado para resolver o Problema da \knap{} é o \textit{knapsack\_dp()}~(\textbf{Algoritmo~\ref{alg:knap_dp}}), 
%um algoritmo pseudo-polinomial que usa programação dinâmica e possui complexidade de tempo 
%de $O(C \cdot |E|)$~\cite{wolsey}.
%
%O \textbf{Algoritmo~\ref{alg:knap}} \textit{knapsack()} constrói a matriz usando o \textit{knapsack\_dp()} e recupera a solução
%usando o \textbf{Algoritmo~\ref{alg:knap_sol}} \textit{knapsack\_sol()}, algoritmo recursivo que possui complexidade de tempo de $O(|E|)$.

\subsection{\rl{2} - \pcmc{}}
\label{subsec:relaxlag_rl2}

A relaxação \rl{2} tem como problema primal lagrangeano o \pcmc{}. Dado um grafo $G = (V, E)$ simples 
não-orientado e dois vértices distintos $s$ e $t$, o \mpcmc{} é encontrar o menor caminho $P^{*}$ que 
liga os vértices $s$ e $t$.

O problema primal lagrangeano da relaxação \rl{2} possui o seguinte modelo:

Função Objetivo:

\begin{equation}
\label{eq:fo_rl2}
z(u) = \min \sum_{(i, j) \in E} (d_{i, j} + u \cdot c_{i, j}). x_{i, j} - u \cdot C
\end{equation} \\

Sujeito a:

\begin{align}
\label{eq:restr_rl2_pcmc}
&\sum_{j \in V} x_{s, j} = 1 \nonumber \\
&\sum_{i \in V} x_{i, t} = 1 \\
&\sum_{j \in V} x_{i, j} - \sum_{j \in V} x_{j, i} = 1, \qquad \forall i \in V\backslash\{s, t\} \nonumber
\end{align}

\begin{equation}
\label{eq:restr_rl2_x}
x_{i, j} \in \mathbb{B}, \qquad \forall (i, j) \in E
\end{equation} \\

\subsubsection{Custos Lagrangeanos}
\label{subsubsec:custo_lag_rl2}

Para a relaxação \rl{2}, o custo lagrangeano é o custo relacionado a restrição de custo 
do caminho (\ref{eq:restr_pli_knap}).

\begin{align}
\tilde{c}_{i, j} = d_{i, j} + u \cdot c_{i, j}. \nonumber\\
\end{align}

\subsubsection{Detalhes da Implementação}
\label{subsubsec:alg_rl2}

O algoritmo implementado para resolver o \pcmc{} é o algoritmo de Dijkstra, implementação
simples com vetores, que possui complexidade de tempo de $O(|V|^{2})$~\cite{cormen}.

Então para pegar o menor caminho do vértice $s$ para o vértice $t$ usa-se o algoritmo de Dijkstra para calcular as distâncias de $s$
para todos os vértices, e depois retorna o custo do caminho e as arestas pertencentes ao caminho de $s$ e $t$.

%O algoritmo implementado para resolver o \pcmc{} é o algoritmo de Dijkstra~(\textbf{Algoritmo~\ref{alg:dijkstra}}), implementação
%simples com vetores, que possui complexidade de tempo de $O(|V|^{2})$~\cite{cormen}.
%
%O \textbf{Algoritmo~\ref{alg:dijkstra}} calcula os caminhos mais curtos do vértice de origem $s$ para todos os outros vértices do grafo $G$. 
%A função \textit{EXTRACT\_MIN()} retorna o elemento com a menor valor de distância no conjunto $Q$, 
%removendo-o do conjunto $Q$.
%
%O \textbf{Algoritmo~\ref{alg:shortest_path}} \textit{shortest\_path()} usa o algoritmo de Dijkstra para calcular as distâncias, e
%pega o menor caminho do vértice de origem $s$ para o vértice destino $t$, retornando o custo 
%do caminho e as arestas pertencentes a este caminho.

\subsection{Força dos Limitantes}
\label{subsec:str_bound}

Para analisar a força dos limitantes temos que verificar se modelo define a sua envoltória convexa. O limitante será melhor
se o espaço definido pelo modelo está mais próximo da envoltória convexa.

A formulação da relaxação \rl{1} não define a envoltória para o Problema da \knap{}, mas fornece um limitante melhor
que a relaxação linear do problema. Já a formulação da relaxação \rl{2}, que é um caso particular do Problema de Fluxo Mínimo de Redes,
define a envoltória do \pcmc{}. Portanto os limitantes gerados pela \rl{2} são melhores que os limitantes gerados pela \rl{1}.

\subsection{Critério de Parada}
\label{subsec:crit_parada}

O método do subgradiente para usando os seguintes critérios:

\begin{itemize}
\item{Solução ótima é encontrada.}
\item{Limitante Primal $-$ Limitante Dual $<$ $1$.}
\item{Chegou ao número máximo de iterações.}
\end{itemize}

Se $u \ge 0$, a solução $\bar{x}$ do problema relaxado $IP(u)$ é ótima se:

\begin{itemize}
\item{$\bar{x}$ for solução ótima do problema relaxado $IP(u)$.}
\item{$D \cdot \bar{x} \le d$.}
\item{$(D \cdot \bar{x})_{i} \le d_{i}$, para $u_{i} > 0$.}
\end{itemize}

